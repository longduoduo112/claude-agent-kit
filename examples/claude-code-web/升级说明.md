# Claude Agent SDK 版本升级说明

## 问题描述
在 Windows 11 环境下运行 `examples/claude-code-web` 项目时，遇到错误：
```
Error: Claude Code process exited with code 1
```

原因：项目使用的 `@anthropic-ai/claude-agent-sdk` 版本为 0.1.47，而目标版本是 0.1.76。

## 修复步骤

### 1. 更新依赖
```bash
cd E:\tataanai\claude-agent-kit
# 删除旧的 lock 文件
rm pnpm-lock.yaml
# 重新安装依赖
pnpm install
# 强制更新 SDK 到最新版本
pnpm update @anthropic-ai/claude-agent-sdk@latest -r
```

### 2. 重新构建项目
```bash
pnpm run build
```

### 3. 启动开发服务器
```bash
pnpm --filter claude-code-web dev
```

## 验证结果

✅ SDK 版本已成功升级到 0.1.76：
```bash
$ pnpm list @anthropic-ai/claude-agent-sdk
claude-code-web@0.0.0
dependencies:
@anthropic-ai/claude-agent-sdk 0.1.76
```

✅ 服务器成功启动：
```
Server started at http://localhost:5173
```

## 环境配置（可选）

如需使用完整功能，建议创建 `.env` 文件：

```bash
cd examples/claude-code-web
cp .env.example .env
# 编辑 .env 文件，添加你的 API key
```

最小配置：
```env
ANTHROPIC_API_KEY=your-api-key-here
```

## 兼容性说明

- ✅ Windows 11 支持
- ✅ Node.js 18+
- ✅ @anthropic-ai/claude-agent-sdk 0.1.76
- ✅ 权限模式默认为 `plan`（避免 root 权限问题）

## 常见问题

### 1. 如果仍遇到 "Claude Code process exited with code 1"
- 确保已设置 `ANTHROPIC_API_KEY` 环境变量
- 检查权限模式设置（默认为 `plan`）
- 查看 `examples/claude-code-web/README.md` 的 FAQ 部分

### 2. 端口冲突
如果 5173 端口被占用：
```bash
# Windows
netstat -ano | findstr :5173
taskkill //F //PID <进程ID>

# 或修改 .env 文件
PORT=3000
```

## 升级日期
2025-12-24
